import{c as N,j as e,U as C,S as A,R as h,I as F,B as p,e as V,_ as y,r as g,C as T,a as Q}from"./index-xKrTDA7N.js";import{S}from"./Select-DSiwQjuV.js";import{C as D}from"./Checkbox-CgYu5-DF.js";import{P as M}from"./plus-By_5y3b0.js";import{P as z}from"./pen-C89hxg5V.js";import{T as I}from"./trash-2-B5BVGcKx.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=N("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=N("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);function E({statistics:s}){return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(C,{className:"w-8 h-8 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Gesamtaufrufe"}),e.jsx("p",{className:"text-2xl font-semibold",children:s.totalViews})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k,{className:"w-8 h-8 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Hilfreich-Bewertungen"}),e.jsx("p",{className:"text-2xl font-semibold",children:s.helpfulVotes})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(A,{className:"w-8 h-8 text-purple-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Häufigste Suchanfragen"}),e.jsx("div",{className:"mt-2",children:s.searchQueries.slice(0,3).map(a=>e.jsxs("div",{className:"text-sm",children:[a.term," (",a.count,")"]},a.term))})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(L,{className:"w-8 h-8 text-orange-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Top Kategorien"}),e.jsx("div",{className:"mt-2",children:s.categoryViews.slice(0,3).map(a=>e.jsxs("div",{className:"text-sm",children:["Kategorie ",a.categoryId,": ",a.views," Aufrufe"]},a.categoryId))})]})]})})]})}const P=[{value:"broker",label:"Makler"},{value:"member",label:"Mitglieder"},{value:"employer",label:"Arbeitgeber"},{value:"employee",label:"Arbeitnehmer"},{value:"salary-employee",label:"Arbeitnehmer Gehaltsumwandlung"}];function O({faq:s,categories:a,onSubmit:r,onCancel:t}){const[i,c]=h.useState({question:(s==null?void 0:s.question)||"",answer:(s==null?void 0:s.answer)||"",visibilities:(s==null?void 0:s.visibilities)||[],category:(s==null?void 0:s.category)||"",priority:(s==null?void 0:s.priority)||"medium",searchTerms:(s==null?void 0:s.searchTerms)||[]}),l=async n=>{n.preventDefault(),await r(i)},o=(n,u)=>{c(m=>({...m,visibilities:u?[...m.visibilities,n]:m.visibilities.filter(d=>d!==n)}))};return e.jsxs("form",{onSubmit:l,className:"space-y-6",children:[e.jsx(F,{label:"Frage",value:i.question,onChange:n=>c({...i,question:n.target.value}),required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Antwort"}),e.jsx("textarea",{value:i.answer,onChange:n=>c({...i,answer:n.target.value}),rows:4,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-gray-500 focus:ring-gray-500",required:!0})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Sichtbarkeit"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:P.map(n=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{id:`visibility-${n.value}`,checked:i.visibilities.includes(n.value),onChange:u=>o(n.value,u)}),e.jsx("label",{htmlFor:`visibility-${n.value}`,className:"text-sm text-gray-700",children:n.label})]},n.value))})]}),e.jsxs(S,{label:"Kategorie",value:i.category,onChange:n=>c({...i,category:n.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Kategorie wählen"}),a.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(p,{type:"button",variant:"outline",onClick:t,children:"Abbrechen"}),e.jsx(p,{type:"submit",children:s?"Speichern":"Erstellen"})]})]})}const j=[{id:"1",name:"Allgemein",description:"Allgemeine Fragen zur Plattform",order:0,visibility:"all"},{id:"2",name:"Leasing",description:"Fragen zum Leasingprozess",order:1,visibility:"member"},{id:"3",name:"Makler",description:"Informationen für Makler",order:2,visibility:"broker"}],b=[{id:"1",question:"Wie funktioniert der Leasingprozess?",answer:"Der Leasingprozess beginnt mit der Auswahl eines Fahrzeugs. Nach der Konfiguration können Sie eine unverbindliche Anfrage stellen. Ein Makler wird sich dann mit Ihnen in Verbindung setzen.",visibility:"member",category:"2",priority:"high",views:150,helpfulVotes:45,createdAt:new Date("2024-01-01"),updatedAt:new Date("2024-01-01"),order:0,searchTerms:["leasing","prozess","anfrage","ablauf"]},{id:"2",question:"Wie kann ich neue Mitglieder einladen?",answer:"Als Makler können Sie neue Mitglieder über die Mitgliederverwaltung einladen. Dort haben Sie die Möglichkeit, entweder eine direkte E-Mail-Einladung zu versenden oder einen Einladungslink zu generieren.",visibility:"broker",category:"3",priority:"high",views:89,helpfulVotes:32,createdAt:new Date("2024-01-02"),updatedAt:new Date("2024-01-02"),order:0,searchTerms:["einladung","mitglieder","registrierung"]}],v=V((s,a)=>({faqs:b,categories:j,loading:!1,error:null,statistics:{totalViews:0,helpfulVotes:0,searchQueries:[],categoryViews:[]},fetchFAQs:async()=>{s({loading:!0});try{await new Promise(r=>setTimeout(r,500)),s({faqs:b,categories:j,loading:!1})}catch{s({error:"Failed to fetch FAQs",loading:!1})}},addFAQ:async r=>{s({loading:!0});try{const t={...r,id:Date.now().toString(),views:0,helpfulVotes:0,createdAt:new Date,updatedAt:new Date};s(i=>({faqs:[...i.faqs,t],loading:!1}))}catch{s({error:"Failed to add FAQ",loading:!1})}},updateFAQ:async(r,t)=>{s({loading:!0});try{s(i=>({faqs:i.faqs.map(c=>c.id===r?{...c,...t,updatedAt:new Date}:c),loading:!1}))}catch{s({error:"Failed to update FAQ",loading:!1})}},deleteFAQ:async r=>{s({loading:!0});try{s(t=>({faqs:t.faqs.filter(i=>i.id!==r),loading:!1}))}catch{s({error:"Failed to delete FAQ",loading:!1})}},addCategory:async r=>{s({loading:!0});try{const t={...r,id:Date.now().toString()};s(i=>({categories:[...i.categories,t],loading:!1}))}catch{s({error:"Failed to add category",loading:!1})}},updateCategory:async(r,t)=>{s({loading:!0});try{s(i=>({categories:i.categories.map(c=>c.id===r?{...c,...t}:c),loading:!1}))}catch{s({error:"Failed to update category",loading:!1})}},deleteCategory:async r=>{s({loading:!0});try{s(t=>({categories:t.categories.filter(i=>i.id!==r),faqs:t.faqs.filter(i=>i.category!==r),loading:!1}))}catch{s({error:"Failed to delete category",loading:!1})}},incrementViews:async r=>{const t=a().faqs.find(i=>i.id===r);t&&await a().updateFAQ(r,{views:t.views+1})},voteHelpful:async r=>{const t=a().faqs.find(i=>i.id===r);t&&await a().updateFAQ(r,{helpfulVotes:t.helpfulVotes+1})},recordSearchQuery:r=>{s(t=>{const c=t.statistics.searchQueries.find(l=>l.term===r)?t.statistics.searchQueries.map(l=>l.term===r?{...l,count:l.count+1}:l):[...t.statistics.searchQueries,{term:r,count:1}];return{statistics:{...t.statistics,searchQueries:c.sort((l,o)=>o.count-l.count)}}})}}));function H(){const{faqs:s,categories:a,addFAQ:r,updateFAQ:t,deleteFAQ:i}=v(),[c,l]=h.useState(!1),[o,n]=h.useState(null),u=async d=>{try{o?await t(o.id,d):await r(d),l(!1),n(null)}catch(x){console.error("Failed to save FAQ:",x)}},m=async d=>{confirm("Sind Sie sicher, dass Sie diese FAQ löschen möchten?")&&await i(d.id)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"FAQ Verwaltung"}),e.jsxs(p,{onClick:()=>l(!0),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"FAQ hinzufügen"]})]}),e.jsx("div",{className:"grid gap-4",children:s.map(d=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:d.question}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Sichtbar für: ",d.visibility==="all"?"Alle":d.visibility==="broker"?"Makler":"Mitglieder"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>{n(d),l(!0)},children:e.jsx(z,{className:"w-4 h-4"})}),e.jsx(p,{variant:"ghost",size:"sm",onClick:()=>m(d),children:e.jsx(I,{className:"w-4 h-4 text-red-500"})})]})]}),e.jsx("p",{className:"text-gray-600",children:d.answer})]},d.id))}),e.jsx(y,{open:c,onClose:()=>{l(!1),n(null)},className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen p-4",children:[e.jsx(y.Overlay,{className:"fixed inset-0 bg-black/30"}),e.jsxs("div",{className:"relative bg-white rounded-xl max-w-2xl w-full p-6",children:[e.jsx(y.Title,{className:"text-xl font-semibold mb-6",children:o?"FAQ bearbeiten":"Neue FAQ erstellen"}),e.jsx(O,{faq:o||void 0,categories:a,onSubmit:u,onCancel:()=>{l(!1),n(null)}})]})]})})]})}function B(s){const[a,r]=g.useState({totalViews:0,helpfulVotes:0,searchQueries:[],categoryViews:[]});return g.useEffect(()=>{const t=s.reduce((l,o)=>l+o.views,0),i=s.reduce((l,o)=>l+o.helpfulVotes,0),c=s.reduce((l,o)=>{const n=l.find(u=>u.categoryId===o.category);return n?n.views+=o.views:l.push({categoryId:o.category,views:o.views}),l},[]);r({...a,totalViews:t,helpfulVotes:i,categoryViews:c.sort((l,o)=>o.views-l.views)})},[s]),a}function K(){const{faqs:s}=v(),a=B(s);return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8 space-y-8",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"FAQ Verwaltung"}),e.jsx(E,{statistics:a}),e.jsx(H,{})]})}function U(s,a){const[r,t]=g.useState(s);return g.useEffect(()=>{const i=setTimeout(()=>{t(s)},a);return()=>{clearTimeout(i)}},[s,a]),r}function W({onSearch:s,placeholder:a="Suchen Sie nach Fragen..."}){const[r,t]=h.useState(""),i=U(r,300);return h.useEffect(()=>{s(i)},[i,s]),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(F,{type:"text",value:r,onChange:c=>t(c.target.value),placeholder:a,className:"pl-10"})]})}function R({categories:s,selectedCategory:a,onCategoryChange:r}){return e.jsxs(S,{value:a,onChange:t=>r(t.target.value),className:"w-full",children:[e.jsx("option",{value:"all",children:"Alle Kategorien"}),s.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})}function _({faq:s,onVoteHelpful:a}){const[r,t]=h.useState(!1);return e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsxs("button",{onClick:()=>t(!r),className:"w-full text-left px-4 py-3 flex items-center justify-between bg-white hover:bg-gray-50",children:[e.jsx("span",{className:"font-medium",children:s.question}),e.jsx(T,{className:`w-5 h-5 transform transition-transform ${r?"rotate-180":""}`})]}),r&&e.jsxs("div",{className:"px-4 py-3 bg-gray-50",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:s.answer}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("button",{onClick:()=>a(s.id),className:"flex items-center text-gray-500 hover:text-gray-700",children:[e.jsx(k,{className:"w-4 h-4 mr-1"}),"War das hilfreich? (",s.helpfulVotes,")"]}),e.jsxs("span",{children:[s.views," Aufrufe"]})]})]})]})}function $({faqs:s,onVoteHelpful:a}){const r=[...s].sort((t,i)=>{const c={high:3,medium:2,low:1},l=c[i.priority]-c[t.priority];return l!==0?l:i.helpfulVotes-t.helpfulVotes});return e.jsx("div",{className:"space-y-4",children:r.map(t=>e.jsx(_,{faq:t,onVoteHelpful:a},t.id))})}function G(s){const[a,r]=g.useState(""),t=g.useCallback(()=>{if(!a)return s;const i=a.toLowerCase();return s.filter(c=>{var u;const l=c.question.toLowerCase().includes(i),o=c.answer.toLowerCase().includes(i),n=(u=c.searchTerms)==null?void 0:u.some(m=>m.toLowerCase().includes(i));return l||o||n})},[s,a]);return{searchTerm:a,setSearchTerm:r,filteredFAQs:t()}}function Y(){const{user:s}=Q(),{faqs:a,categories:r,updateFAQ:t}=v(),[i,c]=h.useState("all"),l=a.filter(d=>{var w;const x=(s==null?void 0:s.role)&&((w=d.visibilities)==null?void 0:w.includes(s.role)),f=i==="all"||d.category===i;return x&&f}),{searchTerm:o,setSearchTerm:n,filteredFAQs:u}=G(l),m=async d=>{const x=a.find(f=>f.id===d);x&&await t(d,{helpfulVotes:x.helpfulVotes+1})};return e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Häufig gestellte Fragen"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx(W,{onSearch:n,placeholder:"Wonach suchen Sie?"})}),e.jsx("div",{children:e.jsx(R,{categories:r,selectedCategory:i,onCategoryChange:c})})]}),e.jsx($,{faqs:u,onVoteHelpful:m})]})}function te(){const{user:s}=Q();return(s==null?void 0:s.role)==="admin"?e.jsx(K,{}):e.jsx(Y,{})}export{te as default};
