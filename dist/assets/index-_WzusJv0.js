import{c as y,u as S,j as e,o as L,B as d,v as N,R as j,U as A,I as E,M as k,n as i,s as u,i as z,k as p}from"./index-xKrTDA7N.js";import{T as b}from"./trash-2-B5BVGcKx.js";import{I as R}from"./ImageUpload-BBo6YDMe.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=y("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=y("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);function I(){const t=S(),o=[{title:"Logo & Branding",description:"Verwalten Sie das Portal-Logo und Branding-Einstellungen",path:"logo"},{title:"Administrator-Verwaltung",description:"Verwalten Sie Administrator-Zugänge und Berechtigungen",path:"admins"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-gray-600"})}),e.jsx("h2",{className:"text-lg font-medium",children:"Allgemeine Einstellungen"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(n=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:n.title}),e.jsx("p",{className:"text-gray-600 mb-4",children:n.description}),e.jsx(d,{variant:"outline",onClick:()=>t(n.path),children:"Einstellungen öffnen"})]},n.path))})]})}function M(){const{admins:t,inviteAdmin:o,removeAdmin:n}=N(),[s,c]=j.useState(""),m=async a=>{if(a.preventDefault(),!!s)try{await o(s),c(""),i.success("Admin-Einladung wurde versendet")}catch{i.error("Fehler beim Versenden der Einladung")}},g=async a=>{if(confirm("Möchten Sie diesem Benutzer wirklich die Admin-Rechte entziehen?"))try{await n(a),i.success("Admin-Rechte wurden entzogen")}catch{i.error("Fehler beim Entziehen der Admin-Rechte")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:e.jsx(A,{className:"w-5 h-5 text-gray-600"})}),e.jsx("h2",{className:"text-lg font-medium",children:"Admin-Verwaltung"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Neuen Administrator einladen"}),e.jsxs("form",{onSubmit:m,className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(E,{type:"email",value:s,onChange:a=>c(a.target.value),placeholder:"E-Mail-Adresse",required:!0,leftIcon:e.jsx(k,{className:"w-5 h-5 text-gray-400"})})}),e.jsx(d,{type:"submit",children:"Einladen"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"font-medium",children:"Aktive Administratoren"})}),e.jsx("div",{className:"divide-y divide-gray-200",children:t.map(a=>e.jsxs("div",{className:"px-6 py-4 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.email})]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>g(a.id),className:"text-red-600 hover:text-red-700",children:e.jsx(b,{className:"w-4 h-4"})})]},a.id))})]})]})}function B(){const{portalLogo:t,updatePortalLogo:o,deletePortalLogo:n}=N(),[s,c]=j.useState(null),[m,g]=j.useState(!1),a=r=>{r.length>0&&c(r[0])},x=async()=>{if(s){g(!0);try{const l=await(await fetch(s)).blob(),f=`logo-${Date.now()}${l.type==="image/svg+xml"?".svg":".png"}`,{data:P,error:v}=await u.storage.from("logos").upload(f,l,{contentType:l.type,upsert:!0});if(v)throw v;const{data:h}=u.storage.from("logos").getPublicUrl(f);if(!(h!=null&&h.publicUrl))throw new Error("Failed to get public URL");await o(h.publicUrl),c(null),i.success("Logo erfolgreich gespeichert")}catch(r){console.error("Error saving logo:",r),i.error("Fehler beim Speichern des Logos")}finally{g(!1)}}},w=async()=>{try{const r=t==null?void 0:t.split("/").pop();if(r){const{error:l}=await u.storage.from("logos").remove([r]);if(l)throw l}await n(),i.success("Logo erfolgreich gelöscht")}catch(r){console.error("Error deleting logo:",r),i.error("Fehler beim Löschen des Logos")}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-lg",children:e.jsx(U,{className:"w-5 h-5 text-gray-600"})}),e.jsx("h2",{className:"text-lg font-medium",children:"Logo-Einstellungen"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[t||s?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"w-48 h-48 relative",children:[e.jsx("img",{src:s||t,alt:"Portal Logo",className:"w-full h-full object-contain"}),!s&&e.jsx(d,{variant:"outline",size:"sm",onClick:w,className:"absolute top-2 right-2 text-red-600 hover:text-red-700",children:e.jsx(b,{className:"w-4 h-4"})})]})}):e.jsx("p",{className:"text-gray-500 mb-4",children:"Kein Logo hochgeladen"}),e.jsxs("div",{className:"mt-6",children:[e.jsx(R,{images:s?[s]:t?[t]:[],onUpload:a,maxFiles:1,acceptedFileTypes:["image/jpeg","image/png","image/svg+xml"],maxFileSize:2*1024*1024}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Unterstützte Formate: JPG, PNG, SVG. Maximale Größe: 2MB"})]}),s&&e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs(d,{onClick:x,disabled:m,className:"w-full sm:w-auto",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),m?"Wird gespeichert...":"Logo speichern"]})})]})]})}function T(){return e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-8",children:"Einstellungen"}),e.jsxs(z,{children:[e.jsx(p,{index:!0,element:e.jsx(I,{})}),e.jsx(p,{path:"admins",element:e.jsx(M,{})}),e.jsx(p,{path:"logo",element:e.jsx(B,{})})]})]})}export{T as default};
